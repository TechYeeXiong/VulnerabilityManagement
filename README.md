<h1>Vulnerability Management</h1>


<h2>Environments and Technologies Used</h2>

- Microsoft Azure (Virtual Machines/Compute)
- Remote Desktop Connection
- OpenVAS
- Powershell

<h2>Operating Systems Used </h2>

- Windows 10
- Linux</b>

<h2>Installation Steps</h2>

<p>
<img src="https://i.imgur.com/pLjssSl.png" height="80%" width="80%" alt="Topology"/>
</p>
<p>
Diagram of entire process
</p>
<br />

<p>
<img src="https://i.imgur.com/0O9CKOU.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/hqvm7mF.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/EnWsM80.png" height="80%" width="80%" alt=""/>
</p>
<p>
Go to the Marketplace → “OpenVAS secured and supported by HOSSTED”. 
“Start with a pre-set configuration” → Pick the weakest one. 
“Continue to Create VM”. 
(Resource Group: Vulnerability-Management) 
(VM Name: OpenVAS) 
(Authentication: Create a username and password) 
(Monitoring: Disable Boot Diagnostic)  
Click Create. 
After the VM has been created, SSH into it With PowerShell (windows) or Terminal (MacOS) using the credentials you created earlier by typing Credential@PublicIPAddress.
</p>
<br />

<p>
<img src="https://i.imgur.com/Iu6FMCU.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/CZa8gwN.png" height="80%" width="80%" alt=""/>
</p>
<p>
Don’t touch anything, you’ll notice the “Your openvas is deploying, please wait”. 
Wait until it says “hossted stage done”. 
It should show the web app URL and default username and password at this point, attempt to go to the URL in the browser and login with the username and password.
</p>
<br />

<p>
<img src="https://i.imgur.com/73bebeY.png" height="80%" width="80%" alt="Download Wireshark"/>
<img src="https://i.imgur.com/H9fv9w1.png" height="80%" width="80%" alt="Download Wireshark"/>
<img src="https://i.imgur.com/GQn2jju.png" height="80%" width="80%" alt="Download Wireshark"/>
</p>
<p>
Search for Virtual Machines and create a new Virtual Machine. 
Resource Group: Vulnerability-Management. 
VM Name: Win10-Vulnerable. 
Region: Same as the OpenVAS VM (East US 2). 
Virtual Network: Same as OpenVAS (this is important). 
Image: Windows 10 Pro. 
Size: Any size with 2 vCPUs. 
Username: Create a User and Password. 
Networking: Same Vnet as OpenVAS. 
Create the VM. 
After the VM has been created, ensure you can RDP into it with the credentials you created. 
After logging in, make the VM vulnerable. 
Disable the Windows Firewall. 
Install an Old Version of FireFox: Firefox Setup 97.0b5. 
Install an Old Version of VLC Player: vlc-1.1.7-win32. 
Install an Old Version of Adobe Reader: 10.0_AdbeRdr1000_en_US_1_. 
Restart the VM. 
Leave the VM for now. 
</p>
<br />

<p>
<img src="https://i.imgur.com/ildS9hB.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/0XyLDJY.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/exR6xst.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/IMWyYkB.png" height="80%" width="80%" alt=""/>
</p>
<p>
Login to OpenVAS → Assets → Hosts → New Host. 
Add the Client VM PRIVATE IP Address. 
Create a New Target from the Host, name it “Azure Vulnerable VMs”. 
Take note of the credentials. We will add SMB credentials later. 
Create a new Task. 
Name & Comment: “Scan - Azure Vulnerable VMs”. 
Scan Targets → “Azure Vulnerable VMs”. 
Save the Task. 
“Start” the “Scan - Azure Vulnerable VMs” Task. 
Once the scan is finished, click the date under “Last Report” to see the results. 
Take note of Tabs, specifically the “Results” tab. Even though we installed a super old version of Firefox, note that it does not show up here. 
Note that this is because we aren’t running a credentialed scan so the scanner could not discover it. We will configure credential scans next.
</p>
<br />

<p>
<img src="https://i.imgur.com/63vkM0o.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/u6H8P6n.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/5Po9PXJ.png" height="80%" width="80%" alt=""/>
</p>
<p>
Disable Windows Firewall. 
Disable User Account Control. 
Enable Remote Registry. 
Set Registry Key. 
Launch Registry Editor (regedit.exe) in “Run as administrator” mode and grant Admin Approval, if requested. 
Navigate to HKEY_LOCAL_MACHINE hive. 
Open SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System key. 
Create a new DWORD (32-bit) value with the following properties:  Name: LocalAccountTokenFilterPolicy  Value:1 
Next step = Close Registry Editor. 
Restart the VM
</p>
<br />

<p>
<img src="https://i.imgur.com/kSQgIln.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/zUrUWIo.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/JF8ds9Y.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/NAqBfUM.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/7OtAGq4.png" height="80%" width="80%" alt=""/>
</p>
<p>
Make Configurations for Credentialed Scans (OpenVAS):
Go to Configuration → Credentials → New Credential. 
Name / Comment → “Azure VM Credentials”. 
(Allow Insecure Use = Yes) 
(Username: azureuser) 
(Password: Cyberlab123!) 
Save. 
Go to Configuration → Targets → CLONE the Target we made before. 
NEW Name / Comment: “Azure Vulnerable VMs - Credentialed Scan”. 
Ensure the Private IP is still accurate. 
Credentials → SMB → Select the Credentials we just made: Azure VM Credentials. 
Save.
Within Greenbone / OpenVAS, go to Scans → Tasks. 
CLONE the “Scan - Azure Vulnerable VMs” Task, then Edit it. 
Name / Comment → “Scan - Azure Vulnerable VMs - Credentialed”. 
Targets: Azure Vulnerable VMs - Credentialed Scan. 
Save. 
Click the Play button to launch the new Credentialed Scan, wait for it to finish. 
It will take longer than the last one. Wait for it to finish. 
After the credentialed scan finishes, you can immediately see the difference in findings. 

</p>
<br />

<p>
<img src="https://i.imgur.com/VbPdPxj.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/bkNJSC6.png" height="80%" width="80%" alt=""/>
<img src="https://i.imgur.com/T7ox1yR.png" height="80%" width="80%" alt=""/>
</p>
<p>
Remediate Vulnerabilities. 
Log back into your Win10-Vulnerable VM. 
Uninstall Adobe Reader, VLC Player, and Firefox. 
Restart the VM. 
Verify Remediations. 
Re-initiate the “Scan - Azure Vulnerable VMs - Credentialed” scan and observe the results. 
</p>
<br />
